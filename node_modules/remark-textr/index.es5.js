'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = attacher;

var _unistUtilVisit = require('unist-util-visit');

var _unistUtilVisit2 = _interopRequireDefault(_unistUtilVisit);

var _textr2 = require('textr');

var _textr3 = _interopRequireDefault(_textr2);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }

function attacher(processor) {
  var _ref = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];

  var _ref$plugins = _ref.plugins;
  var plugins = _ref$plugins === undefined ? [] : _ref$plugins;
  var _ref$options = _ref.options;
  var options = _ref$options === undefined ? {} : _ref$options;

  return function transformer(ast) {
    (0, _unistUtilVisit2.default)(ast, 'text', function (node) {
      var _textr;

      node.value = (_textr = (0, _textr3.default)(options)).use.apply(_textr, _toConsumableArray(plugins.map(function (p) {
        return typeof p === 'string' ? require(p) : p;
      })))(node.value);
    });
  };
}
module.exports = exports['default'];
